@model dynamic

@{
    Layout = null;
}

<!DOCTYPE html>

<html>
    <head>
        <title>title</title>
        <script type="text/javascript">
            // First, parse the query string
            var params = {}, queryString = location.hash.substring(1),
            regex = /([^&=]+)=([^&]*)/g, m;
            
            while (m = regex.exec(queryString)) {
                params[decodeURIComponent(m[1])] = decodeURIComponent(m[2]);
            }

            // And send the token over to the server
            var req = new XMLHttpRequest();

            // ver .getJSON
            // consider using POST so query isn't logged
            req.open('GET', 'https://www.googleapis.com/tasks/v1/users/@@me/lists?access_token=' + params['access_token'], true);

            req.onreadystatechange = function (e) {
                if (req.readyState == 4) {
                    if (req.status == 200) {
                        window.location = params['state'];
                    }
                    else if (req.status == 400) {
                        alert('There was an error processing the token.');
                    }
                    else {
                        alert(req.status);
                        alert('something else other than 200 was returned');
                    }
                }
            };
            
            req.send(null);
        </script>
    </head>
    <body>
        <div>
              
        </div>
    </body>
</html>